{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬íšŒììš© ëœë¤ ë½‘ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-800 text-white flex flex-col items-center justify-center h-screen p-4">
    <div id="profile-display" class="w-full max-w-2xl bg-white text-gray-800 rounded-xl shadow-lg p-8 text-center transition-opacity duration-500 opacity-0">
        <!-- í”„ë¡œí•„ ë‚´ìš©ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
    </div>
    <button id="draw-btn" class="mt-8 bg-yellow-400 text-gray-900 font-bold text-2xl py-4 px-10 rounded-lg shadow-lg hover:bg-yellow-300 transition-transform duration-200 hover:scale-105">
        ë‹¤ìŒ ì‚¬ëŒ ë½‘ê¸°!
    </button>
    <script>
        const display = document.getElementById('profile-display');
        const drawBtn = document.getElementById('draw-btn');

        async function drawNextPerson() {
            display.classList.add('opacity-0');
            drawBtn.disabled = true;
            drawBtn.textContent = 'ë½‘ëŠ” ì¤‘...';

            try {
                const response = await fetch("{% url 'profiles:get_random_profile_data' %}");
                const person = await response.json();

                // [ìˆ˜ì •] ìê¸°ì†Œê°œì™€ TMIë¥¼ í‘œì‹œí•˜ëŠ” HTMLì„ ìƒì„±í•©ë‹ˆë‹¤.
                let bioHtml = person.bio ? `
                    <div class="mt-6 text-left">
                        <h2 class="text-lg font-semibold text-gray-700">ìê¸°ì†Œê°œ</h2>
                        <p class="mt-2 text-gray-600">${person.bio.replace(/\n/g, '<br>')}</p>
                    </div>` : '';

                let funFactHtml = person.fun_fact ? `
                    <div class="mt-6 text-left bg-purple-50 p-4 rounded-lg">
                        <h2 class="text-lg font-semibold text-purple-700">TMI / Fun Fact! ğŸ¥³</h2>
                        <p class="mt-2 text-purple-800">${person.fun_fact}</p>
                    </div>` : '';

                display.innerHTML = `
                    <img src="${person.profile_image_url || 'https://placehold.co/150x150/EFEFEF/AAAAAA?text=No+Image'}" class="w-32 h-32 rounded-full object-cover mx-auto border-4 border-white shadow-md mb-4">
                    <h1 class="text-4xl font-bold">${person.name}</h1>
                    <p class="text-gray-500 mt-1 text-lg">${person.group} / ${person.team}</p>
                    ${bioHtml}
                    ${funFactHtml}
                `;
                display.classList.remove('opacity-0');
            } catch (error) {
                display.innerHTML = '<p class="text-red-500">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
                display.classList.remove('opacity-0');
            } finally {
                drawBtn.disabled = false;
                drawBtn.textContent = 'ë‹¤ìŒ ì‚¬ëŒ ë½‘ê¸°!';
            }
        }
        drawBtn.addEventListener('click', drawNextPerson);
        drawNextPerson(); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ ì‚¬ëŒì„ ë°”ë¡œ ë½‘ìŠµë‹ˆë‹¤.
    </script>
</body>
</html>